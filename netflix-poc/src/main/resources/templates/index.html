<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Netflix POC</title>
    <style>
        :root {
            --ink: #f8fafc;
            --muted: #cbd5f5;
            --accent: #e50914;
            --accent-soft: rgba(229, 9, 20, 0.18);
            --card: rgba(17, 24, 39, 0.9);
            --card-strong: #111827;
            --border: rgba(148, 163, 184, 0.2);
            --highlight: #f97316;
            --bg: radial-gradient(circle at 10% 20%, rgba(88, 28, 135, 0.3), transparent 40%),
                  radial-gradient(circle at 80% 10%, rgba(229, 9, 20, 0.25), transparent 35%),
                  linear-gradient(140deg, #030712 0%, #0f172a 45%, #1f2937 100%);
        }
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: "Sora", "Trebuchet MS", sans-serif;
            color: var(--ink);
            background: var(--bg);
        }
        h1, h2 {
            font-family: "Bebas Neue", "Impact", sans-serif;
            letter-spacing: 0.04em;
            margin: 0 0 10px;
        }
        h3 {
            margin: 0 0 8px;
        }
        .page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px 22px 70px;
        }
        .hero {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 18px;
            background: linear-gradient(135deg, rgba(229, 9, 20, 0.18), rgba(15, 23, 42, 0.9));
            border-radius: 24px;
            padding: 28px 30px;
            box-shadow: 0 26px 60px rgba(0, 0, 0, 0.4);
            animation: rise 0.6s ease;
        }
        .hero h1 {
            font-size: 38px;
        }
        .hero p {
            margin: 0;
            color: var(--muted);
            max-width: 520px;
        }
        .pill {
            align-self: flex-start;
            padding: 8px 16px;
            border-radius: 999px;
            background: var(--accent-soft);
            color: #fecdd3;
            font-weight: 700;
            font-size: 12px;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }
        .meta {
            margin-top: 12px;
            color: var(--muted);
            font-size: 14px;
        }
        .message {
            margin-top: 18px;
            background: rgba(249, 115, 22, 0.2);
            border-left: 4px solid var(--highlight);
            padding: 12px 14px;
            border-radius: 10px;
            color: #fed7aa;
        }
        .grid {
            display: grid;
            gap: 20px;
            margin-top: 24px;
        }
        @media (min-width: 980px) {
            .grid { grid-template-columns: 1.25fr 0.75fr; }
        }
        .card {
            background: var(--card);
            border-radius: 18px;
            padding: 22px 24px;
            border: 1px solid var(--border);
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.35);
            animation: rise 0.8s ease;
        }
        form { display: grid; gap: 12px; }
        label { font-weight: 700; font-size: 13px; text-transform: uppercase; letter-spacing: 0.08em; color: #94a3b8; }
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 10px 12px;
            border-radius: 10px;
            border: 1px solid rgba(148, 163, 184, 0.3);
            background: rgba(15, 23, 42, 0.85);
            color: var(--ink);
            font-size: 14px;
        }
        textarea { min-height: 86px; resize: vertical; }
        input:focus, select:focus, textarea:focus {
            outline: 2px solid rgba(229, 9, 20, 0.3);
            border-color: var(--accent);
        }
        .row { display: grid; gap: 12px; }
        @media (min-width: 640px) {
            .row.two { grid-template-columns: repeat(2, 1fr); }
        }
        button {
            background: var(--accent);
            color: #fff;
            border: none;
            border-radius: 10px;
            padding: 12px 14px;
            font-weight: 700;
            cursor: pointer;
        }
        button:hover { filter: brightness(1.05); }
        .ghost {
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.35);
        }
        .list {
            display: grid;
            gap: 12px;
            margin-top: 14px;
        }
        .list-item {
            background: rgba(15, 23, 42, 0.75);
            border-radius: 14px;
            padding: 12px 14px;
            border: 1px solid rgba(148, 163, 184, 0.18);
        }
        .list-row {
            display: flex;
            justify-content: space-between;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }
        .tag {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            border-radius: 999px;
            background: rgba(148, 163, 184, 0.2);
            font-size: 12px;
            color: #e2e8f0;
            font-weight: 600;
        }
        .tags { display: flex; flex-wrap: wrap; gap: 6px; }
        .muted { color: var(--muted); font-size: 13px; }
        .empty { color: var(--muted); font-style: italic; }
        .score {
            color: #fecdd3;
            font-weight: 700;
            font-size: 13px;
        }
        .progress {
            height: 8px;
            background: rgba(148, 163, 184, 0.2);
            border-radius: 999px;
            overflow: hidden;
        }
        .progress span {
            display: block;
            height: 100%;
            background: linear-gradient(90deg, #f97316, #e50914);
        }
        .helper {
            font-size: 12px;
            color: #94a3b8;
        }
        @keyframes rise {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
<div class="page">
    <header class="hero">
        <div>
            <h1>Netflix POC</h1>
            <p>A streaming catalog playground with recommendations, watchlists, and playback tracking. Everything runs in memory for quick system-design iterations.</p>
            <div class="meta">
                Active profile: <strong th:text="${activeProfile.name}">Avery</strong> ·
                Catalog size: <span th:text="${#lists.size(catalog)}">0</span> titles ·
                Default recs: <span th:text="${defaultLimit}">6</span>
            </div>
        </div>
        <div class="pill">Catalog + Recs + Playback</div>
    </header>

    <div th:if="${message}" class="message" th:text="${message}"></div>

    <div class="grid">
        <section>
            <div class="card">
                <h2>For You</h2>
                <p class="muted">Genre-aware ranking blending popularity and recency.</p>
                <div class="list" th:if="${recommendations}">
                    <div class="empty" th:if="${#lists.isEmpty(recommendations)}">No recommendations yet.</div>
                    <div class="list-item" th:each="rec : ${recommendations}">
                        <div class="list-row">
                            <strong th:text="${rec.rank} + '. ' + ${rec.title}">1. Aurora Falls</strong>
                            <span class="score" th:text="'Score ' + ${#numbers.formatDecimal(rec.score, 0, 1)}">Score 120</span>
                        </div>
                        <div class="list-row">
                            <span class="muted" th:text="${rec.type} + ' · ' + ${rec.year}">SERIES · 2024</span>
                            <span class="helper" th:text="${rec.reason}">Matched 2 favorite genres</span>
                        </div>
                        <div class="tags" th:if="${rec.genres}">
                            <span class="tag" th:each="genre : ${rec.genres}" th:text="${genre}">Drama</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h2>Continue Watching</h2>
                <p class="muted">Jump back into unfinished titles.</p>
                <div class="list" th:if="${continueWatching}">
                    <div class="empty" th:if="${#lists.isEmpty(continueWatching)}">No active sessions yet.</div>
                    <div class="list-item" th:each="entry : ${continueWatching}">
                        <div class="list-row">
                            <strong th:text="${entry.title}">Signal Nine</strong>
                            <span class="muted" th:text="${entry.progress} + '% watched'">40% watched</span>
                        </div>
                        <div class="progress"><span th:style="'width:' + ${entry.progress} + '%'">&nbsp;</span></div>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h2>Your Watchlist</h2>
                <p class="muted">Titles saved for later.</p>
                <div class="list" th:if="${watchlist}">
                    <div class="empty" th:if="${#lists.isEmpty(watchlist)}">Watchlist is empty.</div>
                    <div class="list-item" th:each="item : ${watchlist}">
                        <div class="list-row">
                            <strong th:text="${item.title}">Luna Coast</strong>
                            <span class="muted" th:text="${item.type} + ' · ' + ${item.year}">SERIES · 2023</span>
                        </div>
                        <div class="tags">
                            <span class="tag" th:each="genre : ${item.genres}" th:text="${genre}">Drama</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h2>Trending Now</h2>
                <p class="muted">Based on playback starts and popularity.</p>
                <div class="list" th:if="${trending}">
                    <div class="empty" th:if="${#lists.isEmpty(trending)}">No trending titles yet.</div>
                    <div class="list-item" th:each="item : ${trending}">
                        <div class="list-row">
                            <strong th:text="${item.title}">Midnight Arcade</strong>
                            <span class="muted" th:text="${item.plays} + ' plays'">3 plays</span>
                        </div>
                        <div class="list-row">
                            <span class="muted" th:text="${item.type} + ' · ' + ${item.maturityRating}">MOVIE · PG-13</span>
                            <span class="helper" th:text="${item.popularity} + ' popularity'">92 popularity</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h2>Catalog Results</h2>
                <p class="muted">Search across titles and filter by genre.</p>
                <div class="list" th:if="${catalog}">
                    <div class="empty" th:if="${#lists.isEmpty(catalog)}">No titles match your search.</div>
                    <div class="list-item" th:each="item : ${catalog}">
                        <div class="list-row">
                            <strong th:text="${item.title}">Atlas Zero</strong>
                            <span class="muted" th:text="${item.year} + ' · ' + ${item.durationMinutes} + ' min'">2022 · 132 min</span>
                        </div>
                        <div class="list-row">
                            <span class="muted" th:text="${item.type} + ' · ' + ${item.maturityRating}">MOVIE · PG-13</span>
                            <span class="helper" th:text="${item.popularity} + ' popularity'">77 popularity</span>
                        </div>
                        <div class="tags">
                            <span class="tag" th:each="genre : ${item.genres}" th:text="${genre}">Thriller</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section>
            <div class="card">
                <h3>Switch Profile & Search</h3>
                <form th:action="@{/}" method="get">
                    <div>
                        <label for="profileId">Profile</label>
                        <select id="profileId" name="profileId">
                            <option th:each="profile : ${profiles}"
                                    th:value="${profile.id}"
                                    th:selected="${profile.id == activeProfile.id}"
                                    th:text="${profile.name}">Avery</option>
                        </select>
                    </div>
                    <div>
                        <label for="query">Title search</label>
                        <input id="query" name="query" type="text" placeholder="e.g. Midnight" th:value="${query}">
                    </div>
                    <div>
                        <label for="genre">Genre filter</label>
                        <select id="genre" name="genre">
                            <option value="">All genres</option>
                            <option th:each="g : ${genres}" th:value="${g}" th:selected="${g == genreFilter}" th:text="${g}">Drama</option>
                        </select>
                    </div>
                    <button type="submit">Refresh view</button>
                </form>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h3>Add to Watchlist</h3>
                <form th:action="@{/watchlist}" method="post">
                    <input type="hidden" name="profileId" th:value="${activeProfile.id}">
                    <div>
                        <label for="contentId">Content ID</label>
                        <input id="contentId" name="contentId" type="text" placeholder="midnight-arcade">
                    </div>
                    <div class="row two">
                        <button type="submit">Add to watchlist</button>
                        <button type="submit" name="remove" value="true" class="ghost">Remove</button>
                    </div>
                </form>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h3>Playback Update</h3>
                <form th:action="@{/playback}" method="post">
                    <input type="hidden" name="profileId" th:value="${activeProfile.id}">
                    <div>
                        <label for="playContentId">Content ID</label>
                        <input id="playContentId" name="contentId" type="text" placeholder="signal-nine">
                    </div>
                    <div>
                        <label for="progress">Progress (%)</label>
                        <input id="progress" name="progress" type="number" min="0" max="100" placeholder="45">
                        <div class="helper">Set to 100 to mark complete.</div>
                    </div>
                    <button type="submit">Save playback</button>
                </form>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h3>Add or Update Title</h3>
                <form th:action="@{/catalog}" method="post">
                    <input type="hidden" name="profileId" th:value="${activeProfile.id}">
                    <div class="row two">
                        <div>
                            <label for="id">ID</label>
                            <input id="id" name="id" type="text" placeholder="ember-lake">
                        </div>
                        <div>
                            <label for="type">Type</label>
                            <select id="type" name="type">
                                <option value="MOVIE">Movie</option>
                                <option value="SERIES">Series</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label for="title">Title</label>
                        <input id="title" name="title" type="text" placeholder="Ember Lake">
                    </div>
                    <div class="row two">
                        <div>
                            <label for="year">Year</label>
                            <input id="year" name="year" type="number" min="1900" max="2100" value="2024">
                        </div>
                        <div>
                            <label for="durationMinutes">Duration (min)</label>
                            <input id="durationMinutes" name="durationMinutes" type="number" min="1" max="1000" value="110">
                        </div>
                    </div>
                    <div class="row two">
                        <div>
                            <label for="maturityRating">Maturity rating</label>
                            <input id="maturityRating" name="maturityRating" type="text" placeholder="TV-14">
                        </div>
                        <div>
                            <label for="popularity">Popularity (0-100)</label>
                            <input id="popularity" name="popularity" type="number" min="0" max="100" value="80">
                        </div>
                    </div>
                    <div>
                        <label for="genres">Genres (comma-separated)</label>
                        <input id="genres" name="genres" type="text" placeholder="Drama, Mystery">
                    </div>
                    <div>
                        <label for="description">Description</label>
                        <textarea id="description" name="description" placeholder="Short synopsis..."></textarea>
                    </div>
                    <button type="submit">Save title</button>
                </form>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h3>Create Profile</h3>
                <form th:action="@{/profiles}" method="post">
                    <div>
                        <label for="name">Profile name</label>
                        <input id="name" name="name" type="text" placeholder="Jordan">
                    </div>
                    <div>
                        <label for="favoriteGenres">Favorite genres</label>
                        <input id="favoriteGenres" name="favoriteGenres" type="text" placeholder="Sci-Fi, Drama">
                    </div>
                    <div>
                        <label for="maturityLimit">Maturity limit</label>
                        <input id="maturityLimit" name="maturityLimit" type="text" placeholder="TV-14">
                    </div>
                    <button type="submit">Create profile</button>
                </form>
            </div>
        </section>
    </div>
</div>
</body>
</html>
